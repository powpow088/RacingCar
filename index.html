<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Survival Racing 2D</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- 主選單 (Pre-Game UI) -->
    <div id="main-menu" class="screen active">
        <h1>生存賽車 2D</h1>

        <div class="menu-section">
            <h2>選擇難度</h2>
            <div class="options-group" id="difficulty-options">
                <button class="diff-btn selected" data-diff="easy">簡單</button>
                <button class="diff-btn" data-diff="normal">普通</button>
                <button class="diff-btn" data-diff="hard">困難</button>
            </div>
            <p id="diff-desc" class="desc-text">起始時間充裕。車流密度低。速度較慢。</p>
        </div>

        <div class="menu-section selection-car-section">
            <h2>選擇車輛</h2>
            <div class="car-showcase-container">
                <div class="car-card selected" data-car="balanced">
                    <canvas class="car-preview" id="preview-balanced" width="60" height="90"></canvas>
                    <h3>均衡型</h3>
                    <p>血量: 10<br>極速: 72 km/h<br>加速: 0.05<br>轉向: 中</p>
                </div>
                <div class="car-card" data-car="heavy">
                    <canvas class="car-preview" id="preview-heavy" width="60" height="90"></canvas>
                    <h3>重裝卡車</h3>
                    <p>血量: 15<br>極速: 50 km/h<br>加速: 0.025<br>轉向: 遲鈍</p>
                </div>
                <div class="car-card" data-car="sports">
                    <canvas class="car-preview" id="preview-sports" width="60" height="90"></canvas>
                    <h3>競速跑車</h3>
                    <p>血量: 5<br>極速: 108 km/h<br>加速: 0.1<br>轉向: 靈敏</p>
                </div>
                <div class="car-card" data-car="ultraman">
                    <canvas class="car-preview" id="preview-ultraman" width="60" height="90"></canvas>
                    <h3>奧特曼</h3>
                    <p>血量: 10<br>極速: 144 km/h<br>加速: 0.15<br>轉向: 超靈敏</p>
                </div>
            </div>
        </div>

        <button id="start-btn" class="action-btn">開始遊戲</button>
    </div>

    <!-- 遊戲進行畫面 (Game UI) -->
    <div id="game-screen" class="screen">
        <!-- 畫布區 -->
        <canvas id="gameCanvas"></canvas>

        <!-- HUD (抬頭顯示器) -->
        <div id="hud">
            <div class="hud-left">
                <div class="hud-item hp-display">血量: <span id="hud-hp">3</span></div>
                <div class="hud-item score-display">距離: <span id="hud-dist">0</span>m</div>
                <div class="hud-item ammo-display" style="display: none;">飛彈: <span id="hud-ammo">Lv.1</span></div>
                <div class="hud-item accel-display" style="display: none;">加速: <span id="hud-accel">0</span></div>
                <div class="hud-item coin-display">金幣: <span id="hud-coins">0</span>/5</div>
            </div>
            <div class="hud-right">
                <div class="hud-item time-display">時間: <span id="hud-time">60.0</span>s</div>
                <div class="hud-item speed-meter-ui">
                    <svg width="120" height="65" viewBox="0 0 120 65" class="speed-svg">
                        <path d="M 15 60 A 45 45 0 0 1 105 60" fill="none" stroke="#16213e" stroke-width="12"
                            stroke-linecap="round" />
                        <path id="speed-arc-fill" d="M 15 60 A 45 45 0 0 1 105 60" fill="none" stroke="#2ecc71"
                            stroke-width="12" stroke-linecap="round" stroke-dasharray="141.4" stroke-dashoffset="141.4"
                            style="transition: stroke-dashoffset 0.1s linear, stroke 0.2s;" />
                        <circle cx="103" cy="58" r="4" fill="#e74c3c" />
                        <g id="speed-needle-grp"
                            style="transform-origin: 60px 60px; transform: rotate(-90deg); transition: transform 0.1s linear;">
                            <polygon points="58,60 62,60 60,20" fill="#e74c3c" />
                            <circle cx="60" cy="60" r="5" fill="#fff" />
                        </g>
                    </svg>
                    <div class="speed-texts">
                        <div class="current-speed"><span id="hud-speed">0</span> <small>km/h</small></div>
                        <div class="max-speed-label">極限 <span id="hud-maxspd">0</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 虛擬按鍵 (Mobile Only) -->
        <div id="virtual-controls">
            <div class="control-group-left">
                <div class="steer-row">
                    <button class="v-btn steer" id="btn-left">◀</button>
                    <button class="v-btn steer" id="btn-right">▶</button>
                </div>
                <button class="v-btn brake" id="btn-brake">▼</button>
            </div>
            <div class="control-group-right">
                <button class="v-btn accel" id="btn-accel">▲</button>
                <button class="v-btn action" id="btn-fire">🎯</button>
            </div>
        </div>

        <!-- 大絕招/特效提示文字 -->
        <div id="effect-notice"></div>
    </div>

    <!-- 遊戲結束畫面 (Game Over UI) -->
    <div id="game-over-screen" class="screen">
        <h1 id="go-title">遊戲結束</h1>
        <p id="go-reason">時間到了！</p>
        <p class="final-score">最終行駛距離: <span id="go-dist">0</span>km</p>
        <p class="final-score" style="font-size:1.5rem; margin-top: -20px;">最高時速: <span id="go-max-speed">0</span>km/h
        </p>

        <div id="save-score-section" style="margin-bottom: 20px; text-align: center;">
            <p style="color:#aeb9cc; margin-bottom: 10px;">是否儲存成績？</p>
            <div style="display:flex; justify-content:center; align-items:center; gap:10px;">
                <input type="text" id="player-name-input" placeholder="輸入玩家名稱"
                    style="padding:8px; font-size:1rem; border-radius:5px; border:1px solid #0f3460; background:#16213e; color:#fff; width:150px;">
                <button id="save-score-btn" class="action-btn" style="font-size: 1rem; padding: 10px 20px;">儲存</button>
            </div>
            <p id="save-msg" style="color:#2ecc71; display:none; margin-top:10px;">成績已儲存！</p>
        </div>

        <div id="leaderboard-container"
            style="background: rgba(0,0,0,0.5); padding: 15px; border-radius: 10px; width: 90%; max-width: 400px; margin-bottom: 20px; border: 1px solid #0f3460;">
            <h2 style="color: #f1c40f; text-align: center; margin-bottom: 10px; text-shadow: 0 0 5px #f1c40f;">🏆 排行榜 🏆
            </h2>
            <div id="leaderboard-list"
                style="max-height: 150px; overflow-y: auto; text-align: left; font-size: 0.95rem;">
                <!-- leaderboard items go here -->
            </div>
        </div>

        <button id="restart-btn" class="action-btn">回主畫面</button>
    </div>

    <script src="audio.js"></script>
    <script src="game.js"></script>
</body>

</html>